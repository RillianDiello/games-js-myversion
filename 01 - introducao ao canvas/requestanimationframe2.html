<!DOCTYPE html>
<html>

<head>
   <title>Método window.requestAnimationFrame</title>
</head>

<body>
	<canvas id="meu_canvas" width="300" height="300"></canvas>
	<script>
		// Canvas e contexto
		canvas = document.getElementById('meu_canvas');
		context = canvas.getContext('2d');
		// Solicito a execução de uma função
		// Não é preciso qualificar o window
		// requestAnimationFrame(minhaFunção)
		// Outro conceito importante é o tempo
		// O requestAnimationFrame trabalha em ciclos do cp q é muito curto
		// O Javascript possui um objeto Date que obtem informações da data e hora
		// atuais atraves do metodo getTime()
		// Agora com o tempo podemos calcular o deslocamento da bolinha

		var x = 20;
		var y = 100;
		var raio = 5;

		// Momento inicial
      	var anterior = new Date().getTime();
      

		requestAnimationFrame(mexerBola);
		

		function mexerBola(){

			var agora = new Date().getTime();

			// Diferença
			var decorrido = agora - anterior;      

			// Limpar o Canvas
			context.clearRect(0, 0, canvas.width, canvas.height);

			// Desenhar a bola
			context.beginPath();
			context.arc(x, y, raio, 0, Math.PI*2);
			context.fill();

			// Deslocar 20 pixels para a direita
			var velocidade = 20;
			x += velocidade * decorrido / 1000;

			// Guardamos o instante para o próximo ciclo
			anterior = agora;

			// Chamar o próximo ciclo da animação
			requestAnimationFrame(mexerBola);

		}
	</script>
</body>
